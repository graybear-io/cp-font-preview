# User Guide

Complete guide to using cp-font-preview.

## Overview

cp-font-preview displays CircuitPython bitmap fonts (PCF/BDF) in a pygame window. It's designed for:

- **Visual verification** - See exactly how fonts render
- **Quick iteration** - Watch mode for rapid development
- **Pre-deployment testing** - Verify fonts before hardware deployment

## Commands

### preview

Display a font in a window.

```bash
cp-font-preview preview --manifest path/to/manifest.json [OPTIONS]
```

**Options:**

- `--manifest`, `-m` - Path to font manifest JSON (required)
- `--watch`, `-w` - Enable watch mode for auto-reload
- `--width` - Window width in pixels (default: 800)
- `--height` - Window height in pixels (default: 600)

**Examples:**

```bash
# Basic preview
cp-font-preview preview --manifest output/digits/digits-manifest.json

# Larger window
cp-font-preview preview --manifest output/emoji/emoji-manifest.json --width 1200 --height 900

# Watch mode
cp-font-preview preview --manifest output/menu/menu-manifest.json --watch
```

### info

Show font metadata without opening a window.

```bash
cp-font-preview info path/to/manifest.json
```

**Output:**

```text
Font Family: emoji
Sizes: 32
Formats: pcf
Character Count: 54

Characters: 0123456789‚òÅ‚ò∫‚ö†‚õÖ‚õà‚úÖ‚ú®‚ùÑ‚ùå‚û°‚¨Ö‚¨Ü‚¨á‚≠êÔ∏èüå°üå§üåßüéâ...

Font Files:
  ‚úì /path/to/output/emoji/emoji-32pt.pcf
```

## Watch Mode

Watch mode monitors the manifest directory and automatically reloads when font files change.

### Workflow

```bash
# Terminal 1: Start preview with watch
cp-font-preview preview --manifest ../cp-font-gen/examples/emoji/output/emoji/emoji-manifest.json --watch

# Terminal 2: Edit and regenerate
cd ../cp-font-gen/examples/emoji
# Edit config.yaml or chars.txt...
cp-font-gen generate --config config.yaml
# ‚Üí Preview updates automatically!
```

### How It Works

1. **Monitors directory** containing the manifest
2. **Detects changes** to `.json`, `.pcf`, `.bdf` files
3. **Debounces updates** to avoid rapid reloads during generation
4. **Reloads manifest** and updates display

### Tips

- Save watch mode for iterative design work
- Keep preview window visible while editing
- Terminal shows reload notifications

## Display Features

### Character Grid

Characters are displayed in a 16-column grid:

```text
A B C D E F G H I J K L M N O P
Q R S T U V W X Y Z 0 1 2 3 4 5
6 7 8 9 ! @ # $ % ^ & * ( ) - +
```

### Window Title

Shows font family and character count:

```text
digits - 10 characters
```

### Layout

- **16 characters per row** - Optimized for typical displays
- **Monospace spacing** - Clear character separation
- **Black background** - Maximum contrast
- **White text** - Standard rendering

## Manifest Format

cp-font-preview reads manifest files generated by cp-font-gen:

```json
{
  "font_family": "digits",
  "sizes": [16],
  "formats": ["pcf", "bdf"],
  "character_count": 10,
  "characters": "0123456789",
  "output_directory": "/path/to/output/digits",
  "generated_files": [
    "digits-16pt.pcf",
    "digits-16pt.bdf"
  ]
}
```

**Required fields:**

- `output_directory` - Where to find font files
- `generated_files` - List of font filenames
- `characters` - String of characters to display
- `font_family` - Font name for title

## Font Format Support

### PCF (Preferred)

- **Portable Compiled Format** - Binary bitmap font
- **CircuitPython native** - Direct support
- **Smaller size** - Compressed format
- **Faster loading** - Binary format

### BDF

- **Bitmap Distribution Format** - ASCII bitmap font
- **CircuitPython supported** - Via adafruit_bitmap_font
- **Larger size** - Text format
- **Slower loading** - Parsing required

**Preference:** cp-font-preview uses PCF files when available, falls back to BDF.

## Window Controls

- **Close window** - Click X or press ESC
- **Ctrl+C in terminal** - Graceful shutdown

## Integration with cp-font-gen

### Typical Workflow

```bash
# 1. Generate fonts
cd cp-font-gen
cp-font-gen generate --config examples/emoji/config.yaml

# 2. Preview results
cd ../cp-font-preview
cp-font-preview preview --manifest ../cp-font-gen/examples/emoji/output/emoji/emoji-manifest.json

# 3. Iterate as needed
# ‚Üí Edit config.yaml
# ‚Üí Regenerate fonts
# ‚Üí Preview updates (if using --watch)

# 4. Deploy to hardware
cp ../cp-font-gen/output/emoji/*.pcf /Volumes/CIRCUITPY/fonts/
```

### Using Justfile Shortcuts

Both projects include justfile commands for common tasks:

```bash
# In cp-font-gen
just generate examples/emoji/config.yaml

# In cp-font-preview
just preview-emoji    # Preview the emoji example
just watch-emoji      # Watch emoji example
```

## Performance Notes

- **Font loading** - First load takes ~1-2 seconds for large fonts
- **Display rendering** - 60 FPS for smooth updates
- **Watch mode** - 500ms debounce prevents rapid reloads
- **Window size** - Larger windows may affect performance on older hardware

## Limitations

### Emoji Rendering

Emoji appear as **monochrome silhouettes**, not full color:

- PCF/BDF are bitmap formats without color information
- CircuitPython uses monochrome displays primarily
- This is expected behavior

### Large Character Sets

- Very large fonts (1000+ glyphs) may not fit in default window
- Increase window size: `--width 1600 --height 1200`
- Or scroll through characters (future feature)

### Font Size

Only previews **one size at a time**:

- If manifest contains multiple sizes, uses first PCF file
- To preview different sizes, regenerate with single size

## Tips and Tricks

### Quick Iteration

Use watch mode + split terminal for fastest workflow:

```bash
# Left terminal: watch mode
cp-font-preview preview --manifest manifest.json --watch

# Right terminal: edit + regenerate
vim config.yaml
cp-font-gen generate --config config.yaml
```

### Verify Before Deploy

Always preview fonts before deploying to hardware:

1. Generate fonts locally
2. Preview to verify all characters
3. Check for missing glyphs
4. Deploy to CircuitPython device

### Font Debugging

Use `info` command to debug issues:

```bash
cp-font-preview info manifest.json
```

Shows:

- Which characters are included
- Whether font files exist
- File paths for debugging

## Next Steps

- **[Configuration](configuration.md)** - Customize behavior
- **[Troubleshooting](troubleshooting.md)** - Fix common issues
- **[Development](development.md)** - Contribute improvements
